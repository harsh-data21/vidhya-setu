{% extends 'base.html' %}
{% block content %}

<!-- ================================================= -->
<!-- ðŸ“‹ Page Heading -->
<!-- ================================================= -->
<h2>ðŸ“‹ Mark Attendance</h2>

<p style="font-weight:bold;">
    Class {{ class_name }} | Section {{ section }} | Date {{ date }}
</p>

<!-- ================================================= -->
<!-- â„¹ï¸ Information Note -->
<!-- ================================================= -->
<p style="color: #555;">
    <b>Note:</b> Agar same date ki attendance dobara submit ki jaati hai,
    to purani attendance <b>UPDATE</b> ho jaayegi (duplicate nahi banegi).
</p>

<hr>

<!-- ================================================= -->
<!-- ðŸ“ Attendance Form -->
<!-- ================================================= -->
<form method="post">
    {% csrf_token %}

    <!-- =============================== -->
    <!-- ðŸ“… Date Selector -->
    <!-- =============================== -->
    <label for="date"><b>Date:</b></label>
    <input
        type="date"
        id="date"
        name="date"
        value="{{ date }}"
        required
    >

    <br><br>

    <!-- =============================== -->
    <!-- ðŸ‘¨â€ðŸŽ“ Students Attendance Table -->
    <!-- students = StudentProfile queryset -->
    <!-- =============================== -->
    <table border="1" cellpadding="10" cellspacing="0" style="width:80%;">
        <tr style="background-color: #f2f2f2;">
            <th>Roll No</th>
            <th>Student Name</th>
            <th>Present</th>
            <th>Absent</th>
        </tr>

        {% for sp in students %}
        <tr>
            <!-- Roll number -->
            <td style="text-align:center;">
                {{ sp.roll_no }}
            </td>

            <!-- Student username -->
            <td>
                {{ sp.user.username }}
            </td>

            <!-- ============================== -->
            <!-- âœ… Present -->
            <!-- name MUST match views.py -->
            <!-- name="status_<user.id>" -->
            <td style="text-align: center;">
                <input
                    type="radio"
                    name="status_{{ sp.user.id }}"
                    value="P"
                    required
                >
            </td>

            <!-- ============================== -->
            <!-- âŒ Absent (default) -->
            <td style="text-align: center;">
                <input
                    type="radio"
                    name="status_{{ sp.user.id }}"
                    value="A"
                    checked
                >
            </td>
        </tr>

        {% empty %}
        <tr>
            <td colspan="4" style="text-align:center;">
                No students found.
            </td>
        </tr>
        {% endfor %}
    </table>

    <br>

    <!-- ================================================= -->
    <!-- ðŸ’¾ Submit Button -->
    <!-- ================================================= -->
    <button type="submit">
        âœ… Save Attendance
    </button>
</form>

{% endblock %}
