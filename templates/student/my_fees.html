{% extends 'base.html' %}
{% block content %}

<h2>ðŸ’° My Fees</h2>
<hr>

<!-- ================= SUMMARY ================= -->
<div style="margin-bottom:20px;">
    <strong>Total Fees:</strong> â‚¹{{ total_amount }} <br>
    <strong>Paid:</strong> â‚¹{{ paid_amount }} <br>
    <strong>Pending:</strong> â‚¹{{ pending_amount }}
</div>

<!-- ================= FEES TABLE ================= -->
<table border="1" cellpadding="10" cellspacing="0" width="100%">
    <tr>
        <th>Class</th>
        <th>Month</th>
        <th>Amount</th>
        <th>Status</th>
        <th>Paid On</th>
        <th>Action</th>
    </tr>

    {% for fee in fees %}
    <tr>
        <td>{{ fee.fee_structure.class_name }}</td>
        <td>{{ fee.fee_structure.month }}</td>
        <td>â‚¹{{ fee.fee_structure.amount }}</td>

        {% if fee.status == 'PAID' %}
            <td style="color:green;"><strong>PAID</strong></td>
            <td>{{ fee.paid_on }}</td>
            <td>
                <a href="{% url 'fee_receipt' fee.id %}" target="_blank">
                    ðŸ§¾ Download Receipt
                </a>
            </td>
        {% else %}
            <td style="color:red;"><strong>PENDING</strong></td>
            <td>â€”</td>
            <td>
                <form method="post" action="{% url 'pay_fee' fee.id %}">
                    {% csrf_token %}
                    <button type="submit">
                        ðŸ’³ Pay Now
                    </button>
                </form>
            </td>
        {% endif %}
    </tr>

    {% empty %}
    <tr>
        <td colspan="6" style="text-align:center;">
            No fee records found.
        </td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
